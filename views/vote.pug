extends layout

block styles
  link(rel="stylesheet", href="/stylesheets/vote.css")
  link(rel="stylesheet", href="/stylesheets/sidebar.css")

block content
  body
    .vote-container
      include includes/sidebar.pug
      .vote-viewer
        .vote
          .vote-top
            if vote.voteStatus === "진행 중"
              p.vote-status.ongoing #{vote.voteStatus}
            else
              p.vote-status.closed #{vote.voteStatus}
            p.expirationDate #{vote.expirationDate}
          .vote-info
            p #{vote.total_voters} 명 참여 중
            p made by #{vote.created_by}
          span.vote-title #{vote.title}
          form#vote-form(action=`/votings/${vote._id}` method="post" onsubmit='submitForm(event)' name='vote-form')
            .scroll
              fieldset.vote-mid
                each option, index in vote.select_options
                  div.option
                    input(type="radio", name="option", id=option.description, value=index required)
                    label(for=option.description) #{option.description}
                if (vote.voteStatus === "진행 중")
                  input#submit.button.form-button(type="submit", value="투표하기" name="submitButton")
                else
                  input#disabled.button.form-button(type="submit", value="투표하기" disabled)
                  h3.vote-disabled-message 투표가 종료되었습니다.
          if errorMessage
            h3.errorMessage #{errorMessage}
          .vote-bottom
            button.button.to-list 목록으로
            if loggedInUser && loggedInUser.username === vote.created_by
              div
                button(onclick='openModal()').button.show-vote-result 결과보기
                button.button.delete-vote 투표 삭제
      .modal
        div(onclick='closeModal()').modal-background
        .modal-window
          .modal-scroll
            each option in vote.select_options
              .option-result
                h1 #{option.description}
                .option-counter-container
                  .option-counter(style=`width: ${option.vote_counter / vote.total_voters * 100 || 0}%`)
                    span #{option.vote_counter / vote.total_voters * 100 || 0}%
  script(src="/javascripts/vote.js")
